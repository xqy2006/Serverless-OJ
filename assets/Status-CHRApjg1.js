import{a as re}from"./axios-DXsv3KKR.js";import{q as z,v as je,_ as we,e as O,x as qe,c as xe,a as s,w as T,p as Ee,r as I,o as ne,b as L,y as Oe,d as P,z as Ce,g as Re,t as D,A as ke}from"./index-BZesiFmf.js";var U,ae;function _e(){if(ae)return U;ae=1;function n(t){var a=typeof t;return t!=null&&(a=="object"||a=="function")}return U=n,U}var W,oe;function Ne(){if(oe)return W;oe=1;var n=typeof z=="object"&&z&&z.Object===Object&&z;return W=n,W}var M,ie;function he(){if(ie)return M;ie=1;var n=Ne(),t=typeof self=="object"&&self&&self.Object===Object&&self,a=n||t||Function("return this")();return M=a,M}var B,le;function Le(){if(le)return B;le=1;var n=he(),t=function(){return n.Date.now()};return B=t,B}var F,se;function Ae(){if(se)return F;se=1;var n=/\s/;function t(a){for(var o=a.length;o--&&n.test(a.charAt(o)););return o}return F=t,F}var H,ue;function Ge(){if(ue)return H;ue=1;var n=Ae(),t=/^\s+/;function a(o){return o&&o.slice(0,n(o)+1).replace(t,"")}return H=a,H}var J,ce;function ye(){if(ce)return J;ce=1;var n=he(),t=n.Symbol;return J=t,J}var Q,de;function Ve(){if(de)return Q;de=1;var n=ye(),t=Object.prototype,a=t.hasOwnProperty,o=t.toString,l=n?n.toStringTag:void 0;function y(b){var p=a.call(b,l),m=b[l];try{b[l]=void 0;var r=!0}catch{}var g=o.call(b);return r&&(p?b[l]=m:delete b[l]),g}return Q=y,Q}var X,fe;function $e(){if(fe)return X;fe=1;var n=Object.prototype,t=n.toString;function a(o){return t.call(o)}return X=a,X}var K,me;function ze(){if(me)return K;me=1;var n=ye(),t=Ve(),a=$e(),o="[object Null]",l="[object Undefined]",y=n?n.toStringTag:void 0;function b(p){return p==null?p===void 0?l:o:y&&y in Object(p)?t(p):a(p)}return K=b,K}var Y,be;function De(){if(be)return Y;be=1;function n(t){return t!=null&&typeof t=="object"}return Y=n,Y}var Z,pe;function Pe(){if(pe)return Z;pe=1;var n=ze(),t=De(),a="[object Symbol]";function o(l){return typeof l=="symbol"||t(l)&&n(l)==a}return Z=o,Z}var ee,ve;function Ue(){if(ve)return ee;ve=1;var n=Ge(),t=_e(),a=Pe(),o=NaN,l=/^[-+]0x[0-9a-f]+$/i,y=/^0b[01]+$/i,b=/^0o[0-7]+$/i,p=parseInt;function m(r){if(typeof r=="number")return r;if(a(r))return o;if(t(r)){var g=typeof r.valueOf=="function"?r.valueOf():r;r=t(g)?g+"":g}if(typeof r!="string")return r===0?r:+r;r=n(r);var c=y.test(r);return c||b.test(r)?p(r.slice(2),c?2:8):l.test(r)?o:+r}return ee=m,ee}var te,ge;function We(){if(ge)return te;ge=1;var n=_e(),t=Le(),a=Ue(),o="Expected a function",l=Math.max,y=Math.min;function b(p,m,r){var g,c,w,E,_,h,C=0,A=!1,R=!1,G=!0;if(typeof p!="function")throw new TypeError(o);m=a(m)||0,n(r)&&(A=!!r.leading,R="maxWait"in r,w=R?l(a(r.maxWait)||0,m):w,G="trailing"in r?!!r.trailing:G);function V(i){var S=g,N=c;return g=c=void 0,C=i,E=p.apply(N,S),E}function v(i){return C=i,_=setTimeout(d,m),A?V(i):E}function e(i){var S=i-h,N=i-C,$=m-S;return R?y($,w-N):$}function q(i){var S=i-h,N=i-C;return h===void 0||S>=m||S<0||R&&N>=w}function d(){var i=t();if(q(i))return x(i);_=setTimeout(d,e(i))}function x(i){return _=void 0,G&&g?V(i):(g=c=void 0,E)}function j(){_!==void 0&&clearTimeout(_),C=0,g=h=c=_=void 0}function f(){return _===void 0?E:x(t())}function k(){var i=t(),S=q(i);if(g=arguments,c=this,h=i,S){if(_===void 0)return v(h);if(R)return clearTimeout(_),_=setTimeout(d,m),V(h)}return _===void 0&&(_=setTimeout(d,m)),E}return k.cancel=j,k.flush=f,k}return te=b,te}var Me=We();const Be=je(Me),Fe={class:"status"},He={class:"header"},Je={class:"filters"},Qe=["href"],Xe=["href"],Ke={class:"pagination"},Ye="xqy2006",Ze="Serverless-OJ",et={__name:"Status",setup(n){const t=O(""),a=O(""),o=O(!1),l=O(1),y=O(10),b=O(0),p=O([]),m=O(!1);let r=null;const g=localStorage.getItem("github_token"),c=JSON.parse(localStorage.getItem("problemIdCache"))||{},w={},E=v=>v.replace("评测","").trim(),_=async v=>{const e=E(v.title);return c[e]?c[e]:w[e]?(await w[e],c[e]):(w[e]=re.get("/problems/list.txt").then(q=>{const x=q.data.split(`
`).map(j=>j.trim()).filter(j=>j).findIndex(j=>j===e)+1;x>0?(c[e]=x,localStorage.setItem("problemIdCache",JSON.stringify(c))):(console.error(`未找到题目名称: ${e}`),c[e]=null)}).catch(q=>{console.error("获取问题列表失败:",q),c[e]=null}).finally(()=>{delete w[e]}),await w[e],c[e])},h=async()=>{var v;try{m.value=!0;const e=[`repo:${Ye}/${Ze} is:issue "评测" in:title`];if(t.value&&e.push(`${t.value} in:title`),a.value&&e.push(`label:${a.value}`),o.value){const f=Ee().login;e.push(`author:${f}`)}const q=e.join(" "),d=await re.get("https://api.github.com/search/issues",{headers:{Authorization:`token ${g}`,Accept:"application/vnd.github.v3+json"},params:{q,page:l.value,per_page:y.value,sort:"created",order:"desc"}}),x=d.data.items,j=await Promise.all(x.map(f=>_(f)));p.value=x.map((f,k)=>{var i;return{id:String(f.number),problemId:j[k],html_url:f.html_url,problem:E(f.title),user:f.user.login,result:((i=f.labels.find(S=>["AC","WA","CE","RE","TLE","MLE","OLE","CHEATING"].includes(S.name)))==null?void 0:i.name)||"评测中",submitTime:new Date(f.created_at).toLocaleString()}}),b.value=d.data.total_count}catch(e){console.error("获取评测记录失败:",((v=e.response)==null?void 0:v.data)||e)}finally{m.value=!1}},C=Be(()=>{l.value=1,h()},300),A=()=>{l.value=1,h()},R=v=>{y.value=v,l.value=1,h()},G=v=>{l.value=v,h()},V=v=>({AC:"success",WA:"danger",CE:"info",RE:"danger",TLE:"warning",MLE:"primary",OLE:"primary",CHEATING:"danger",评测中:"info"})[v]||"info";return h(),r=setInterval(()=>{h()},1e4),qe(()=>{r&&clearInterval(r)}),(v,e)=>{const q=I("el-input"),d=I("el-option"),x=I("el-select"),j=I("el-checkbox"),f=I("el-table-column"),k=I("router-link"),i=I("el-tag"),S=I("el-table"),N=I("el-pagination"),$=I("el-card"),Te=I("el-col"),Se=I("el-row"),Ie=ke("loading");return ne(),xe("div",Fe,[s(Se,{justify:"center"},{default:T(()=>[s(Te,{xs:24,sm:22,md:20},{default:T(()=>[s($,{class:"status-card"},{header:T(()=>[L("div",He,[e[6]||(e[6]=L("h2",null,"评测状态",-1)),L("div",Je,[s(q,{modelValue:t.value,"onUpdate:modelValue":e[0]||(e[0]=u=>t.value=u),placeholder:"搜索题目名称","prefix-icon":"Search",class:"filter-item",onInput:Oe(C)},null,8,["modelValue","onInput"]),s(x,{modelValue:a.value,"onUpdate:modelValue":e[1]||(e[1]=u=>a.value=u),placeholder:"评测结果",class:"filter-item",onChange:A},{default:T(()=>[s(d,{label:"全部",value:""}),s(d,{label:"通过",value:"AC"}),s(d,{label:"答案错误",value:"WA"}),s(d,{label:"编译错误",value:"CE"}),s(d,{label:"运行错误",value:"RE"}),s(d,{label:"超时",value:"TLE"}),s(d,{label:"内存超限",value:"MLE"}),s(d,{label:"输出超限",value:"OLE"}),s(d,{label:"作弊",value:"CHEATING"})]),_:1},8,["modelValue"]),s(j,{modelValue:o.value,"onUpdate:modelValue":e[2]||(e[2]=u=>o.value=u),class:"filter-item",onChange:A},{default:T(()=>e[5]||(e[5]=[P(" 只看我的 ")])),_:1},8,["modelValue"])])])]),default:T(()=>[Ce((ne(),Re(S,{data:p.value,style:{width:"100%"},class:"responsive-table"},{default:T(()=>[s(f,{prop:"id",label:"提交ID","min-width":"90"},{default:T(u=>[L("a",{href:u.row.html_url,target:"_blank"},D(u.row.id),9,Qe)]),_:1}),s(f,{prop:"problem",label:"题目","min-width":"120"},{default:T(u=>[s(k,{to:`/submit/${u.row.problemId}`},{default:T(()=>[P(D(u.row.problem),1)]),_:2},1032,["to"])]),_:1}),s(f,{prop:"result",label:"结果","min-width":"90"},{default:T(u=>[s(i,{type:V(u.row.result)},{default:T(()=>[P(D(u.row.result),1)]),_:2},1032,["type"])]),_:1}),s(f,{prop:"user",label:"提交用户","min-width":"100"},{default:T(u=>[L("a",{href:`https://github.com/${u.row.user}`,target:"_blank"},D(u.row.user),9,Xe)]),_:1}),s(f,{prop:"submitTime",label:"提交时间","min-width":"160"})]),_:1},8,["data"])),[[Ie,m.value]]),L("div",Ke,[s(N,{"current-page":l.value,"onUpdate:currentPage":e[3]||(e[3]=u=>l.value=u),"page-size":y.value,"onUpdate:pageSize":e[4]||(e[4]=u=>y.value=u),total:b.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next",onSizeChange:R,onCurrentChange:G,class:"responsive-pagination"},null,8,["current-page","page-size","total"])])]),_:1})]),_:1})]),_:1})])}}},nt=we(et,[["__scopeId","data-v-bd0be80d"]]);export{nt as default};
